.container
  .panel.panel-default
    %h1.panel-heading Your Order
    .panel-body
      %p Look over your items, add a few more, or proceed to checkout.
      = flash[:toomany]
      %table.table.table-striped
        %tbody
        -if @order.empty?
          %tr You don't have any items in your cart!
        -else
          -@order.items.each do |item|
            %tr
              %td Title: #{item.title}
              %td Description: #{item.description}
              %td Unit Price: $ #{item.price}
              %td Quantity:
              %td
                = form_for 'item', method: 'PUT', :url => {:controller => 'order_items', action: :update, id: order_item(item) } do |f|
                  .field
                    = f.number_field :quantity, :value => order_item(item).quantity
                    = submit_tag "Update", class: "btn btn-primary"
              %td= button_to "Remove", delete_item_order_path(@order, item_id: item.id), class: "btn btn-danger"
              %td Subtotal: $#{item.price * order_item(item).quantity}

    #order-status
      %h4.text-muted= "Order Status: #{@order.aasm_state}"
      -unless @order.basket?
        %h4.text-muted= "Order Submitted at: #{@order.created_at}"
      -if @order.completed? || @order.cancelled?
        %h4.text-muted= "Order Inactive: #{@order.updated_at}"
    #order-total
      %h3.text-muted.pull-right= "Total: $#{@order.total}"


-if signed_in?
  .container
    .row.pull-right
      %ul.nav.nav-pills
        %li.active
          = link_to "Proceed to Checkout", checkout_path
-else
  .container
    .col-lg-5-offset-3.pull-right
      %h5.alert.alert-warning You'll need to log in or sign up to complete your order.
  .container
    .col-lg-5-offset-3.pull-right
      %ul.nav.nav-pills
        %li.active
          %a{href: login_path} Login
        %li.active
          %a{href: signup_path} Signup
